<!DOCTYPE html>
<html lang="en">
<!-- base.html  10 December 2021 10:30:05 EAT -->
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
    {% load static %}
    <title>Elkanah Malonza | Messages</title>
    <link rel='shortcut icon' type='image/x-icon' href="{% static 'main/img/favicon.ico' %}" />

    <!-- General CSS Files -->
    <link rel="stylesheet" href="{% static 'admin/css/app.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/bundles/bootstrap-social/bootstrap-social.css' %}">
    <script src="https://kit.fontawesome.com/00b6dc780b.js" crossorigin="anonymous"></script>
    <!-- Template CSS -->
    <link rel="stylesheet" href="{% static 'admin/css/style.css' %}">
    <link rel="stylesheet" href="{% static 'admin/css/components.css' %}">
</head>

<body>
    <div class="loader"></div>
    <div id="app">
    	
        <!-- Main Content -->
      	<div class="">
	        <section class="section">
	          	<div class="section-body">
	            	<div class="row">
	              		<div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
	                		<div class="card">
	                  			<div class="body">
	                    			<div id="plist" class="people-list">
	                      				<div class="chat-search">
	                        				<input type="text" class="form-control" placeholder="Search..." />
	                      				</div>
	                      				<div class="m-b-20">
	                        				<div id="chat-scroll">
	                          					<ul class="chat-list list-unstyled m-b-0">
	                          					{% for message in messages %}
						                            <li id="message-{{message.id}}" class="clearfix message-sender {% if forloop.first %}active{% endif %}">
							                            <div class="about">
							                                <div class="name">{{message.first_name}} {{message.last_name}}</div>
							                                <div class="status">
							                                  <i class="material-icons online">fiber_manual_record</i>
							                                  {{message.email}}</div>
							                            </div>
						                            </li>
						                        {% endfor %}
	                          					</ul>
	                        				</div>
	                      				</div>
	                    			</div>
	                  			</div>
	                		</div>
	              		</div>
			            <div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">
			                <div class="card">
				                <div class="chat">
				                    <div class="chat-header clearfix">
				                    {% for message in messages %}
				                    	{% if forloop.first %}
				                      	<img src="assets/img/users/user-1.png" alt="avatar">
					                    <div class="chat-about">
					                        <div class="chat-with">{{message.first_name}} {{message.last_name}}</div>
					                        <div class="chat-num-messages">{{message.email}}</div>
					                    </div>
					                	{% endif %}
					                {% endfor %}
				                    </div>
				                </div>
			                  	<div class="chat-box" id="mychatbox">
				                    <div class="card-body chat-content">
				                    {% for message in messages %}
				                    	{% if forloop.first %}
				                    	<div class="chat-item chat-left chat-{{message.id}}">
				                    	{% else %}
				                    	<div class="chat-item chat-left chat-{{message.id}}" style="display: none;">
				                    	{% endif %}
      										<img src="">
      										<div class="chat-details">
      											<div class="chat-text">{{message.message}}</div>
      											<div class="chat-time">{{message.date_created}}</div>
      										</div>
      									</div>
      								{% endfor %}
				                    </div>
				                    <div class="card-footer chat-form">
					                    <form id="chat-form">
					                        <input type="text" class="form-control" placeholder="Type a message">
					                        <button class="btn btn-primary">
					                        	<i class="far fa-paper-plane"></i>
					                        </button>
					                    </form>
				                    </div>
			                  	</div>
			                </div>
			            </div>
	            	</div>
	          	</div>
	        </section>
      	</div>
    </div>
    <!-- General JS Scripts -->
    <script src="{% static 'admin/js/app.min.js' %}"></script>

    <!-- Template JS File -->
    <script src="{% static 'admin/js/scripts.js' %}"></script>
    <script type="text/javascript">
    	{% for message in messages %}
    	$("#message-{{message.id}}").click(function(event){
    		//alert("{{message.first_name}}");
    		$(".chat-with").html("{{message.first_name}} {{message.last_name}}");
    		$(".message-sender").removeClass("active");
    		$(this).addClass("active");
    		$(".chat-item").hide();
    		$(".chat-{{message.id}}").show(); 		
    	});
    	{% endfor %}
    </script>
</body>